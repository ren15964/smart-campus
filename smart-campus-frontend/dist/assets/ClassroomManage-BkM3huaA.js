import{_ as A,s as N,c as O,b as y,a as l,w as a,E as r,r as i,h as f,o as R,f as c,z as C,Q as D,g as L}from"./index-CWfbs8s0.js";const I={class:"admin-classroom-manage"},Q={class:"header-buttons",style:{"margin-bottom":"20px"}},S={class:"dialog-footer"},G={__name:"ClassroomManage",setup(H){const b=f([]),m=f(!1),d=f(!1),u=f(null),s=L({id:null,name:"",capacity:30,location:""}),w={name:[{required:!0,message:"请输入教室名称",trigger:"blur"}],capacity:[{required:!0,message:"请输入容量",trigger:"change"}],location:[{required:!0,message:"请输入位置",trigger:"blur"}]},V=()=>new Promise(o=>{setTimeout(()=>{o({code:200,data:[{id:1,name:"教1-101",capacity:60,location:"教学楼1层"},{id:2,name:"教2-205",capacity:100,location:"教学楼2层"},{id:3,name:"实训楼A-301",capacity:40,location:"实训楼A座3层"}]})},500)}),k=o=>new Promise(e=>{setTimeout(()=>{console.log("模拟添加教室:",o),e({code:200,msg:"添加成功"})},500)}),x=(o,e)=>new Promise(t=>{setTimeout(()=>{console.log(`模拟更新教室 ${o}:`,e),t({code:200,msg:"更新成功"})},500)}),T=o=>new Promise(e=>{setTimeout(()=>{console.log(`模拟删除教室: ${o}`),e({code:200,msg:"删除成功"})},500)}),_=async()=>{try{const o=await V();o.code===200?b.value=o.data:r.error(o.msg||"获取教室列表失败")}catch{r.error("网络错误或服务器异常")}},h=()=>{d.value=!1,m.value=!0,C(()=>{var o;(o=u.value)==null||o.resetFields(),Object.assign(s,{id:null,name:"",capacity:30,location:""})})},B=o=>{d.value=!0,m.value=!0,C(()=>{Object.assign(s,o)})},E=async o=>{D.confirm(`确定要删除教室 [${o.name}] 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=await T(o.id);e.code===200?(r.success(e.msg),_()):r.error(e.msg||"删除失败")}catch{r.error("网络错误或服务器异常")}}).catch(()=>{r.info("已取消删除")})},$=()=>{var o;(o=u.value)==null||o.validate(async e=>{if(e)try{let t;d.value?t=await x(s.id,s):t=await k(s),t.code===200?(r.success(t.msg),m.value=!1,_()):r.error(t.msg||"操作失败")}catch{r.error("网络错误或服务器异常")}})},F=()=>{var o;(o=u.value)==null||o.resetFields(),Object.assign(s,{id:null,name:"",capacity:30,location:""})};return N(()=>{_()}),(o,e)=>{const t=i("el-button"),p=i("el-table-column"),M=i("el-table"),P=i("el-card"),v=i("el-input"),g=i("el-form-item"),U=i("el-input-number"),j=i("el-form"),q=i("el-dialog");return R(),O("div",I,[e[10]||(e[10]=y("h2",null,"教室资源管理",-1)),l(P,null,{default:a(()=>[y("div",Q,[l(t,{type:"primary",onClick:h},{default:a(()=>[...e[5]||(e[5]=[c("添加教室",-1)])]),_:1})]),l(M,{data:b.value,border:"",style:{width:"100%"}},{default:a(()=>[l(p,{prop:"name",label:"教室名称",width:"150"}),l(p,{prop:"capacity",label:"容量",width:"100"}),l(p,{prop:"location",label:"位置"}),l(p,{label:"操作",width:"150"},{default:a(n=>[l(t,{link:"",type:"primary",size:"small",onClick:z=>B(n.row)},{default:a(()=>[...e[6]||(e[6]=[c("编辑",-1)])]),_:1},8,["onClick"]),l(t,{link:"",type:"danger",size:"small",onClick:z=>E(n.row)},{default:a(()=>[...e[7]||(e[7]=[c("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(q,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=n=>m.value=n),title:d.value?"编辑教室":"添加教室",width:"500px",onClose:F},{footer:a(()=>[y("span",S,[l(t,{onClick:e[3]||(e[3]=n=>m.value=!1)},{default:a(()=>[...e[8]||(e[8]=[c("取消",-1)])]),_:1}),l(t,{type:"primary",onClick:$},{default:a(()=>[...e[9]||(e[9]=[c("确定",-1)])]),_:1})])]),default:a(()=>[l(j,{model:s,rules:w,ref_key:"classroomFormRef",ref:u,"label-width":"100px"},{default:a(()=>[l(g,{label:"教室名称",prop:"name"},{default:a(()=>[l(v,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=n=>s.name=n),placeholder:"请输入教室名称"},null,8,["modelValue"])]),_:1}),l(g,{label:"容量",prop:"capacity"},{default:a(()=>[l(U,{modelValue:s.capacity,"onUpdate:modelValue":e[1]||(e[1]=n=>s.capacity=n),min:1,max:500},null,8,["modelValue"])]),_:1}),l(g,{label:"位置",prop:"location"},{default:a(()=>[l(v,{modelValue:s.location,"onUpdate:modelValue":e[2]||(e[2]=n=>s.location=n),placeholder:"请输入教室位置"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},K=A(G,[["__scopeId","data-v-58f6fca1"]]);export{K as default};
