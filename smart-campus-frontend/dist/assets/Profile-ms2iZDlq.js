import{_ as C,s as h,c as k,a,w as r,a0 as I,E as n,r as u,g as B,d as F,o as G,f as p,b as _,h as M,a1 as R}from"./index-jCaZfwQD.js";const T={class:"user-profile-container"},q={__name:"Profile",setup(E){const g=F(),f=M(null),l=B({id:null,username:"",realName:"",role:"",email:"",phone:"",avatar:"",createTime:""}),b={realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:["blur","change"]}]},c=async()=>{try{const o=await I();o.code===200?Object.assign(l,o.data):n.error(o.message||"获取用户信息失败")}catch(o){console.error("获取用户信息失败:",o),n.error("获取用户信息失败，请稍后再试")}},V=()=>{var o;(o=f.value)==null||o.validate(async e=>{if(e)try{const s=await R(l);s.code===200?n.success("个人信息更新成功"):n.error(s.message||"个人信息更新失败")}catch(s){console.error("个人信息更新失败:",s),n.error("个人信息更新失败，请稍后再试")}})},v=()=>{c()},y=(o,e)=>{o.code===200?(l.avatar=o.data.filePath,n.success("头像上传成功")):n.error(o.message||"头像上传失败")},N=o=>{const e=o.type==="image/jpeg"||o.type==="image/png",s=o.size/1024/1024<2;return e||n.error("上传头像图片只能是 JPG/PNG 格式!"),s||n.error("上传头像图片大小不能超过 2MB!"),e&&s},P=()=>{g.push({name:"PasswordChange"})};return h(()=>{c()}),(o,e)=>{const s=u("el-avatar"),U=u("el-upload"),d=u("el-form-item"),m=u("el-input"),i=u("el-button"),w=u("el-form"),x=u("el-card");return G(),k("div",T,[a(x,{class:"box-card"},{header:r(()=>[...e[6]||(e[6]=[_("div",{class:"card-header"},[_("span",null,"个人中心")],-1)])]),default:r(()=>[a(w,{model:l,rules:b,ref_key:"userInfoFormRef",ref:f,"label-width":"100px",class:"profile-form"},{default:r(()=>[a(d,{label:"头像"},{default:r(()=>[a(U,{class:"avatar-uploader",action:"/api/file/upload","show-file-list":!1,"on-success":y,"before-upload":N},{default:r(()=>[a(s,{size:80,src:l.avatar},null,8,["src"])]),_:1})]),_:1}),a(d,{label:"用户名"},{default:r(()=>[a(m,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=t=>l.username=t),disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"姓名",prop:"realName"},{default:r(()=>[a(m,{modelValue:l.realName,"onUpdate:modelValue":e[1]||(e[1]=t=>l.realName=t)},null,8,["modelValue"])]),_:1}),a(d,{label:"角色"},{default:r(()=>[a(m,{modelValue:l.role,"onUpdate:modelValue":e[2]||(e[2]=t=>l.role=t),disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"邮箱",prop:"email"},{default:r(()=>[a(m,{modelValue:l.email,"onUpdate:modelValue":e[3]||(e[3]=t=>l.email=t)},null,8,["modelValue"])]),_:1}),a(d,{label:"手机号",prop:"phone"},{default:r(()=>[a(m,{modelValue:l.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>l.phone=t)},null,8,["modelValue"])]),_:1}),a(d,{label:"创建时间"},{default:r(()=>[a(m,{modelValue:l.createTime,"onUpdate:modelValue":e[5]||(e[5]=t=>l.createTime=t),disabled:""},null,8,["modelValue"])]),_:1}),a(d,null,{default:r(()=>[a(i,{type:"primary",onClick:V},{default:r(()=>[...e[7]||(e[7]=[p("保存修改",-1)])]),_:1}),a(i,{onClick:v},{default:r(()=>[...e[8]||(e[8]=[p("重置",-1)])]),_:1}),a(i,{onClick:P},{default:r(()=>[...e[9]||(e[9]=[p("修改密码",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},z=C(q,[["__scopeId","data-v-1254f27f"]]);export{z as default};
