import{_ as C,u as b,c as x,a as o,w as a,r as d,d as h,o as E,f as w,b as f,h as F,g as k,a2 as B,E as p}from"./index-jCaZfwQD.js";const R={class:"password-change-container"},U={class:"card-header",style:{"font-size":"20px","font-weight":"700",color:"var(--app-text)"}},q={__name:"PasswordChange",setup(N){const m=h(),c=b(),n=F(null),r=k({oldPassword:"",newPassword:"",confirmPassword:""}),P={oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,validator:(t,e,s)=>{e===""?s(new Error("请输入新密码")):e.length<6?s(new Error("密码长度不能少于6位")):(r.confirmPassword!==""&&n.value.validateField("confirmPassword"),s())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(t,e,s)=>{e===""?s(new Error("请再次输入新密码")):e!==r.newPassword?s(new Error("两次输入的密码不一致!")):s()},trigger:"blur"}]},_=()=>{var t;(t=n.value)==null||t.validate(async e=>{if(e)try{const s=await B({oldPassword:r.oldPassword,newPassword:r.newPassword});s.code===200?(p.success("密码修改成功，请重新登录"),c.logout(),m.push("/login")):p.error(s.message||"密码修改失败")}catch(s){console.error("密码修改失败:",s),p.error("密码修改失败，请稍后再试")}})},g=()=>{var t;(t=n.value)==null||t.resetFields()},v=()=>{m.back()};return(t,e)=>{const s=d("el-button"),u=d("el-input"),i=d("el-form-item"),V=d("el-form"),y=d("el-card");return E(),x("div",R,[o(y,{class:"box-card"},{header:a(()=>[f("div",U,[e[4]||(e[4]=f("span",null,"修改密码",-1)),o(s,{type:"primary",link:"",onClick:v},{default:a(()=>[...e[3]||(e[3]=[w("返回",-1)])]),_:1})])]),default:a(()=>[o(V,{model:r,rules:P,ref_key:"passwordFormRef",ref:n,"label-width":"100px",class:"password-form"},{default:a(()=>[o(i,{label:"旧密码",prop:"oldPassword"},{default:a(()=>[o(u,{modelValue:r.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.oldPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(i,{label:"新密码",prop:"newPassword"},{default:a(()=>[o(u,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>r.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(i,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[o(u,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(i,null,{default:a(()=>[o(s,{type:"primary",onClick:_},{default:a(()=>[...e[5]||(e[5]=[w("确认修改",-1)])]),_:1}),o(s,{onClick:g},{default:a(()=>[...e[6]||(e[6]=[w("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},M=C(q,[["__scopeId","data-v-8e69277a"]]);export{M as default};
