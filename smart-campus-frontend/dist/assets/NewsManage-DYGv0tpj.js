import{_ as ae,s as oe,c as S,a as t,w as l,r,h as u,o as h,f as d,b,G as ne,H as se,I as re,Q as T,E as p,g as q}from"./index-jCaZfwQD.js";const ue={class:"news-manage"},de={class:"card-header"},ie={class:"dialog-footer"},me={class:"card-header"},ce={class:"dialog-footer"},pe={__name:"NewsManage",setup(ge){const g=u([]),z=u(1),D=u(10),F=u(0),v=u(!1),_=u(!1),w=u(null),n=q({id:null,title:"",categoryId:null,content:"",publishDate:""}),j={title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],categoryId:[{required:!0,message:"请选择新闻分类",trigger:"change"}],content:[{required:!0,message:"请输入新闻内容",trigger:"blur"}]},i=u([]),y=u(!1),C=u(!1),V=u(null),m=q({id:null,name:""}),L={name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},f=()=>{g.value=[{id:1,title:"校园招聘会通知",categoryName:"通知",publishDate:"2026-02-01",categoryId:1,content:"内容1"},{id:2,title:"图书馆闭馆公告",categoryName:"公告",publishDate:"2026-02-05",categoryId:2,content:"内容2"},{id:3,title:"最新学术讲座预告",categoryName:"讲座",publishDate:"2026-02-08",categoryId:3,content:"内容3"}],F.value=g.value.length},O=()=>{_.value=!1,B(),v.value=!0},G=o=>{_.value=!0,Object.assign(n,o),v.value=!0},H=()=>{w.value.validate(async o=>{if(o){if(_.value)p.success("新闻编辑成功！");else{n.id=g.value.length+1,n.publishDate=new Date().toISOString().slice(0,10);const e=i.value.find(s=>s.id===n.categoryId);n.categoryName=e?e.name:"未知",g.value.push({...n}),p.success("新闻发布成功！")}v.value=!1,f()}})},P=o=>{T.confirm(`确定删除新闻 "${o.title}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{g.value=g.value.filter(e=>e.id!==o.id),p.success("删除成功！"),f()}).catch(()=>{p.info("已取消删除")})},B=()=>{n.id=null,n.title="",n.categoryId=null,n.content="",n.publishDate="",w.value&&w.value.resetFields()},Q=o=>{B(),o()},A=o=>{D.value=o,f()},J=o=>{z.value=o,f()},x=()=>{i.value=[{id:1,name:"通知"},{id:2,name:"公告"},{id:3,name:"讲座"},{id:4,name:"活动"}]},K=()=>{C.value=!1,$(),y.value=!0},W=o=>{C.value=!0,Object.assign(m,o),y.value=!0},X=()=>{V.value.validate(async o=>{o&&(C.value?p.success("分类编辑成功！"):(m.id=i.value.length+1,i.value.push({...m}),p.success("分类新增成功！")),y.value=!1,x(),f())})},Y=o=>{T.confirm(`确定删除分类 "${o.name}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{i.value=i.value.filter(e=>e.id!==o.id),p.success("删除成功！"),x(),f()}).catch(()=>{p.info("已取消删除")})},$=()=>{m.id=null,m.name="",V.value&&V.value.resetFields()},Z=o=>{$(),o()};return oe(()=>{x(),f()}),(o,e)=>{const s=r("el-button"),c=r("el-table-column"),E=r("el-table"),ee=r("el-pagination"),R=r("el-card"),N=r("el-input"),k=r("el-form-item"),te=r("el-option"),le=r("el-select"),U=r("el-form"),M=r("el-dialog");return h(),S("div",ue,[t(R,{class:"box-card"},{header:l(()=>[b("div",de,[e[9]||(e[9]=b("span",null,"新闻管理",-1)),t(s,{type:"primary",onClick:O},{default:l(()=>[...e[8]||(e[8]=[d("发布新闻",-1)])]),_:1})])]),default:l(()=>[t(E,{data:g.value,style:{width:"100%"},border:""},{default:l(()=>[t(c,{prop:"id",label:"ID",width:"80"}),t(c,{prop:"title",label:"标题"}),t(c,{prop:"categoryName",label:"分类"}),t(c,{prop:"publishDate",label:"发布日期",width:"180"}),t(c,{label:"操作",width:"200"},{default:l(a=>[t(s,{size:"small",onClick:I=>G(a.row)},{default:l(()=>[...e[10]||(e[10]=[d("编辑",-1)])]),_:1},8,["onClick"]),t(s,{size:"small",type:"danger",onClick:I=>P(a.row)},{default:l(()=>[...e[11]||(e[11]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),t(ee,{onSizeChange:A,onCurrentChange:J,"current-page":z.value,"page-sizes":[10,20,50,100],"page-size":D.value,layout:"total, sizes, prev, pager, next, jumper",total:F.value},null,8,["current-page","page-size","total"])]),_:1}),t(M,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),title:_.value?"编辑新闻":"发布新闻",width:"600px","before-close":Q},{footer:l(()=>[b("span",ie,[t(s,{onClick:e[3]||(e[3]=a=>v.value=!1)},{default:l(()=>[...e[12]||(e[12]=[d("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:H},{default:l(()=>[...e[13]||(e[13]=[d("确定",-1)])]),_:1})])]),default:l(()=>[t(U,{model:n,rules:j,ref_key:"newsFormRef",ref:w,"label-width":"100px"},{default:l(()=>[t(k,{label:"标题",prop:"title"},{default:l(()=>[t(N,{modelValue:n.title,"onUpdate:modelValue":e[0]||(e[0]=a=>n.title=a)},null,8,["modelValue"])]),_:1}),t(k,{label:"分类",prop:"categoryId"},{default:l(()=>[t(le,{modelValue:n.categoryId,"onUpdate:modelValue":e[1]||(e[1]=a=>n.categoryId=a),placeholder:"请选择分类",style:{width:"100%"}},{default:l(()=>[(h(!0),S(ne,null,se(i.value,a=>(h(),re(te,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(k,{label:"内容",prop:"content"},{default:l(()=>[t(N,{type:"textarea",modelValue:n.content,"onUpdate:modelValue":e[2]||(e[2]=a=>n.content=a),rows:8},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(R,{class:"box-card category-manage-card"},{header:l(()=>[b("div",me,[e[15]||(e[15]=b("span",null,"新闻分类管理",-1)),t(s,{type:"primary",onClick:K},{default:l(()=>[...e[14]||(e[14]=[d("新增分类",-1)])]),_:1})])]),default:l(()=>[t(E,{data:i.value,style:{width:"100%"},border:""},{default:l(()=>[t(c,{prop:"id",label:"ID",width:"80"}),t(c,{prop:"name",label:"分类名称"}),t(c,{label:"操作",width:"150"},{default:l(a=>[t(s,{size:"small",onClick:I=>W(a.row)},{default:l(()=>[...e[16]||(e[16]=[d("编辑",-1)])]),_:1},8,["onClick"]),t(s,{size:"small",type:"danger",onClick:I=>Y(a.row)},{default:l(()=>[...e[17]||(e[17]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(M,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=a=>y.value=a),title:C.value?"编辑分类":"新增分类",width:"400px","before-close":Z},{footer:l(()=>[b("span",ce,[t(s,{onClick:e[6]||(e[6]=a=>y.value=!1)},{default:l(()=>[...e[18]||(e[18]=[d("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:X},{default:l(()=>[...e[19]||(e[19]=[d("确定",-1)])]),_:1})])]),default:l(()=>[t(U,{model:m,rules:L,ref_key:"categoryFormRef",ref:V,"label-width":"80px"},{default:l(()=>[t(k,{label:"分类名称",prop:"name"},{default:l(()=>[t(N,{modelValue:m.name,"onUpdate:modelValue":e[5]||(e[5]=a=>m.name=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ve=ae(pe,[["__scopeId","data-v-02e6d4ba"]]);export{ve as default};
