import{_ as y,u as C,c as h,a as o,w as a,r as t,d as x,o as E,f as w,b as f,h as F,g as k,a2 as B,E as m}from"./index-CWfbs8s0.js";const R={class:"password-change-container"},U={class:"card-header"},q={__name:"PasswordChange",setup(N){const p=x(),c=C(),n=F(null),r=k({oldPassword:"",newPassword:"",confirmPassword:""}),P={oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,validator:(d,e,s)=>{e===""?s(new Error("请输入新密码")):e.length<6?s(new Error("密码长度不能少于6位")):(r.confirmPassword!==""&&n.value.validateField("confirmPassword"),s())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(d,e,s)=>{e===""?s(new Error("请再次输入新密码")):e!==r.newPassword?s(new Error("两次输入的密码不一致!")):s()},trigger:"blur"}]},_=()=>{var d;(d=n.value)==null||d.validate(async e=>{if(e)try{const s=await B({oldPassword:r.oldPassword,newPassword:r.newPassword});s.code===200?(m.success("密码修改成功，请重新登录"),c.logout(),p.push("/login")):m.error(s.message||"密码修改失败")}catch(s){console.error("密码修改失败:",s),m.error("密码修改失败，请稍后再试")}})},g=()=>{var d;(d=n.value)==null||d.resetFields()},v=()=>{p.back()};return(d,e)=>{const s=t("el-button"),i=t("el-input"),u=t("el-form-item"),V=t("el-form"),b=t("el-card");return E(),h("div",R,[o(b,{class:"box-card"},{header:a(()=>[f("div",U,[e[4]||(e[4]=f("span",null,"修改密码",-1)),o(s,{type:"primary",link:"",onClick:v},{default:a(()=>[...e[3]||(e[3]=[w("返回",-1)])]),_:1})])]),default:a(()=>[o(V,{model:r,rules:P,ref_key:"passwordFormRef",ref:n,"label-width":"100px",class:"password-form"},{default:a(()=>[o(u,{label:"旧密码",prop:"oldPassword"},{default:a(()=>[o(i,{modelValue:r.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.oldPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"新密码",prop:"newPassword"},{default:a(()=>[o(i,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>r.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[o(i,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(u,null,{default:a(()=>[o(s,{type:"primary",onClick:_},{default:a(()=>[...e[5]||(e[5]=[w("确认修改",-1)])]),_:1}),o(s,{onClick:g},{default:a(()=>[...e[6]||(e[6]=[w("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},T=y(q,[["__scopeId","data-v-e6bb340a"]]);export{T as default};
