import{g as Q,d as G,u as H,b as J}from"./course-CglI6mUT.js";import{A as K}from"./AppEmpty-BAEE0X2a.js";import{_ as W,s as X,c as Y,a as o,w as l,E as m,r as u,h as b,g as k,S as Z,o as N,f,U as ee,I as oe,b as C,z as le,Q as te}from"./index-jCaZfwQD.js";const re={class:"course-manage-container"},ae={class:"card-header"},se={class:"pagination-container"},ne={class:"dialog-footer"},ue={__name:"CourseManage",setup(de){const x=b([]),V=b(!1),p=k({keyword:"",courseType:""}),n=k({current:1,size:10,total:0}),_=b(!1),d=b(!1),w=b(null),a=k({id:null,courseCode:"",courseName:"",credit:0,hours:0,courseType:"",description:""}),$={courseCode:[{required:!0,message:"请输入课程编码",trigger:"blur"}],courseName:[{required:!0,message:"请输入课程名称",trigger:"blur"}],credit:[{required:!0,message:"请输入学分",trigger:"change"}],hours:[{required:!0,message:"请输入学时",trigger:"change"}],courseType:[{required:!0,message:"请选择课程类型",trigger:"change"}]},g=async()=>{V.value=!0;try{const r=await Q({current:n.current,size:n.size,...p});r.code===200&&(x.value=r.data.records,n.total=r.data.total)}catch(r){console.error("获取课程列表失败:",r),m.error("获取课程失败，请稍后再试")}finally{V.value=!1}},B=()=>{n.current=1,g()},T=()=>{p.keyword="",p.courseType="",n.current=1,g()},E=r=>{n.size=r,g()},S=r=>{n.current=r,g()},q=()=>{d.value=!1,_.value=!0},D=r=>{d.value=!0,_.value=!0,le(()=>{Object.assign(a,r)})},F=async r=>{te.confirm(`确定要删除课程《${r.courseName}》吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=await G(r.id);e.code===200?(m.success("删除成功"),g()):m.error(e.message||"删除失败")}catch(e){console.error("删除失败:",e),m.error("删除失败，请稍后再试")}}).catch(()=>{m.info("已取消删除")})},M=()=>{var r;(r=w.value)==null||r.validate(async e=>{if(e)try{let s;d.value?s=await H(a.id,a):s=await J(a),s.code===200?(m.success(`${d.value?"编辑":"添加"}成功`),_.value=!1,g()):m.error(s.message||`${d.value?"编辑":"添加"}失败`)}catch(s){console.error(`${d.value?"编辑":"添加"}失败:`,s),m.error(`${d.value?"编辑":"添加"}失败，请稍后再试`)}})},R=()=>{var r;(r=w.value)==null||r.resetFields(),Object.assign(a,{id:null,courseCode:"",courseName:"",credit:0,hours:0,courseType:"",description:""})};return X(()=>{g()}),(r,e)=>{const s=u("el-button"),v=u("el-input"),i=u("el-form-item"),y=u("el-option"),z=u("el-select"),h=u("el-form"),c=u("el-table-column"),j=u("el-table"),A=u("el-pagination"),I=u("el-card"),U=u("el-input-number"),L=u("el-dialog"),O=Z("loading");return N(),Y("div",re,[o(I,{class:"box-card"},{header:l(()=>[C("div",ae,[e[13]||(e[13]=C("span",null,"课程管理",-1)),o(s,{type:"primary",onClick:q},{default:l(()=>[...e[12]||(e[12]=[f("添加课程",-1)])]),_:1})])]),default:l(()=>[o(h,{inline:!0,model:p,class:"search-form"},{default:l(()=>[o(i,{label:"课程名称"},{default:l(()=>[o(v,{modelValue:p.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>p.keyword=t),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])]),_:1}),o(i,{label:"课程类型"},{default:l(()=>[o(z,{modelValue:p.courseType,"onUpdate:modelValue":e[1]||(e[1]=t=>p.courseType=t),placeholder:"请选择课程类型",clearable:""},{default:l(()=>[o(y,{label:"必修",value:"必修"}),o(y,{label:"选修",value:"选修"})]),_:1},8,["modelValue"])]),_:1}),o(i,null,{default:l(()=>[o(s,{type:"primary",onClick:B},{default:l(()=>[...e[14]||(e[14]=[f("查询",-1)])]),_:1}),o(s,{onClick:T},{default:l(()=>[...e[15]||(e[15]=[f("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),ee((N(),oe(j,{data:x.value,border:"",style:{width:"100%"}},{empty:l(()=>[o(K,{description:"暂无课程"},{default:l(()=>[o(s,{type:"primary",onClick:T},{default:l(()=>[...e[16]||(e[16]=[f("清空筛选",-1)])]),_:1})]),_:1})]),default:l(()=>[o(c,{prop:"id",label:"ID",width:"80"}),o(c,{prop:"courseCode",label:"课程编码",width:"120"}),o(c,{prop:"courseName",label:"课程名称"}),o(c,{prop:"credit",label:"学分",width:"80"}),o(c,{prop:"hours",label:"学时",width:"80"}),o(c,{prop:"courseType",label:"课程类型",width:"100"}),o(c,{prop:"description",label:"课程简介","show-overflow-tooltip":""}),o(c,{label:"操作",width:"180"},{default:l(t=>[o(s,{type:"primary",link:"",onClick:P=>D(t.row)},{default:l(()=>[...e[17]||(e[17]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"]),o(s,{type:"danger",link:"",onClick:P=>F(t.row)},{default:l(()=>[...e[18]||(e[18]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,V.value]]),C("div",se,[o(A,{"current-page":n.current,"onUpdate:currentPage":e[2]||(e[2]=t=>n.current=t),"page-size":n.size,"onUpdate:pageSize":e[3]||(e[3]=t=>n.size=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:E,onCurrentChange:S},null,8,["current-page","page-size","total"])])]),_:1}),o(L,{modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=t=>_.value=t),title:d.value?"编辑课程":"添加课程",width:"500px",onClose:R},{footer:l(()=>[C("span",ne,[o(s,{onClick:e[10]||(e[10]=t=>_.value=!1)},{default:l(()=>[...e[19]||(e[19]=[f("取消",-1)])]),_:1}),o(s,{type:"primary",onClick:M},{default:l(()=>[...e[20]||(e[20]=[f("确定",-1)])]),_:1})])]),default:l(()=>[o(h,{model:a,rules:$,ref_key:"courseFormRef",ref:w,"label-width":"100px"},{default:l(()=>[o(i,{label:"课程编码",prop:"courseCode"},{default:l(()=>[o(v,{modelValue:a.courseCode,"onUpdate:modelValue":e[4]||(e[4]=t=>a.courseCode=t),disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),o(i,{label:"课程名称",prop:"courseName"},{default:l(()=>[o(v,{modelValue:a.courseName,"onUpdate:modelValue":e[5]||(e[5]=t=>a.courseName=t)},null,8,["modelValue"])]),_:1}),o(i,{label:"学分",prop:"credit"},{default:l(()=>[o(U,{modelValue:a.credit,"onUpdate:modelValue":e[6]||(e[6]=t=>a.credit=t),min:0,max:10,precision:1},null,8,["modelValue"])]),_:1}),o(i,{label:"学时",prop:"hours"},{default:l(()=>[o(U,{modelValue:a.hours,"onUpdate:modelValue":e[7]||(e[7]=t=>a.hours=t),min:0,max:200},null,8,["modelValue"])]),_:1}),o(i,{label:"课程类型",prop:"courseType"},{default:l(()=>[o(z,{modelValue:a.courseType,"onUpdate:modelValue":e[8]||(e[8]=t=>a.courseType=t),placeholder:"请选择课程类型"},{default:l(()=>[o(y,{label:"必修",value:"必修"}),o(y,{label:"选修",value:"选修"})]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"课程简介",prop:"description"},{default:l(()=>[o(v,{modelValue:a.description,"onUpdate:modelValue":e[9]||(e[9]=t=>a.description=t),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},me=W(ue,[["__scopeId","data-v-afbbb68f"]]);export{me as default};
