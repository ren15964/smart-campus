# 预约系统（场地/服务预约）需求示例（复制给AI即可从零搭建）

## A. 项目一句话说明
- **项目名称**：通用预约系统（可用于：场地预约/设备借用/咨询预约/门诊预约）
- **题材类型**：预约
- **核心目标**：实现“可用时段管理 + 用户预约 + 冲突校验 + 审核/取消”，适合答辩展示业务规则与并发处理思路。

## B. 默认技术选型
- **后端**：Spring Boot 2.7.x + Maven + MyBatis Plus + JWT
- **前端**：Vue 3 + Vite + Element Plus + Pinia + Axios + Vue Router
- **数据库**：MySQL 8.x
- **缓存/消息**：Redis（可选；用于锁/限流可加分，但必须可降级）
- **接口风格**：RESTful
- **部署方式**：本地运行即可

## C. 角色与权限
- **角色列表**：
  - 管理员：admin：资源（场地/服务）管理、开放时段配置、预约审核/取消、统计看板
  - 用户：浏览资源、选择时段发起预约、查看/取消自己的预约
  - 处理员（可选）：负责审批与现场核销（若实现则更像真实系统）
- **权限粒度**：菜单级（必做）+ 核销按钮权限（加分）

## D. 功能模块清单
### D1. 基础模块
- JWT 登录/退出/当前用户
- 用户中心：个人信息、修改密码
- 管理端 Layout + 用户端首页

### D2. 业务模块
1) 资源管理（resource）
   - 页面：资源列表、新增/编辑/禁用
   - 规则：资源有状态（启用/禁用），禁用后不可被预约
2) 时段管理（slot）
   - 页面：按资源配置可预约时段（支持批量生成：某资源未来 N 天、每天 9:00-17:00、间隔 30min）
   - 规则：时段必须可被锁定（避免重复预约）
3) 预约管理（booking）
   - 用户端页面：日历/列表选择时段→提交预约；我的预约列表
   - 管理端页面：预约列表（筛选状态）、审核/取消、导出
   - 规则（核心）：
     - 同一时段同一资源只能被一个预约占用（冲突检测）
     - 预约状态流转：`待审核 -> 已通过 -> 已完成(核销)`；驳回/取消为分支
     - 用户只能取消“未开始/未完成”的预约
4) 核销（check-in，可选但加分）
   - 页面：核销列表、核销操作（扫码可不做，直接输入预约码/ID）
   - 规则：已通过的预约才能核销，核销后不可回退

### D3. 加分项（可选）
- 首页看板（ECharts）：各资源预约次数、热门时段、今日待审核数、取消率
- 并发方案说明：数据库唯一约束/乐观锁/Redis 锁（三选一实现最小可用）

## E. 数据模型
### E1. 实体清单
- User：username, password(BCrypt), role_code, nickname, phone, status
- Resource：name, type, location, capacity, status, open_desc
- Slot：resource_id, start_time, end_time, status(可约/已占用/停用)
- Booking：booking_no(唯一), user_id, resource_id, slot_id, status, reason, audit_msg, approve_time, cancel_time
- CheckIn（可选）：booking_id, operator_id, checkin_time, remark
- Role/UserRole（可简化）

### E2. 关系
- Resource 1-N Slot
- User 1-N Booking
- Slot 0-1 Booking（同一 slot 只能有一个有效 booking）

## F. UI/交互要求
- **整体风格**：清爽 + 轻日历风格（预约页突出时间选择体验）
- **预约页**：按天/周切换（简单列表也可），选择时段后弹窗确认
- **提示**：冲突/已被占用要明确提示；提交按钮防重复

## G. 接口与错误码约定
- Header：`Authorization: Bearer <token>`
- 统一返回：`{ code, msg, data }`
- 关键错误码建议：
  - `409xx`：时段冲突/已被预约
  - `400xx`：状态不允许（例如已完成不能取消）

## H. 交付物清单
1) `database.sql`（含初始化：admin/admin123、user1/123456；资源与时段示例数据）
2) 后端：冲突校验必须可用（至少 DB 唯一/状态判断实现）
3) 前端：资源列表、预约页、我的预约、后台预约管理
4) 文档：README + API接口文档（含状态流转说明）
5) 验收：用户预约→管理员审核→用户取消/完成→统计看板刷新

## I. AI 执行指令（强制）
1. 输出目录树/文件清单
2. 生成 `database.sql`（含 slot/booking 约束与索引）
3. 生成后端（冲突校验+状态流转）
4. 生成前端（预约体验与后台管理）
5. 更新 README 与 API 文档
6. 给 Windows PowerShell 启动命令

